<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Python Tips and Gotchas #1 - Replace literals with constants in if-expressions - Andreas Bergström</title><meta name=viewport content="width=device-width,initial-scale=1"><meta property=og:title content="Python Tips and Gotchas #1 - Replace literals with constants in if-expressions"><meta property=og:description content="Whenever you need to check the value of a basic data type, the most straight-forward solution is to use literals:
1 2 3 4  if direction == 'up': # ... elif direction == 'down': # ...   This might seem like pythonic code, but its simplicity could bite you. If you have a lot of conditions and perhaps in multiple locations in your code, what happens if you mistype any of those string literals?"><meta property=og:type content=article><meta property=og:url content=https://andreasbergstrom.com/posts/python-gotchas-and-tips/><meta property=article:published_time content=2019-03-31T15:21:37&#43;01:00><meta property=article:modified_time content=2019-03-31T15:21:37&#43;01:00><meta name=twitter:card content=summary><meta name=twitter:title content="Python Tips and Gotchas #1 - Replace literals with constants in if-expressions"><meta name=twitter:description content="Whenever you need to check the value of a basic data type, the most straight-forward solution is to use literals:
1 2 3 4  if direction == 'up': # ... elif direction == 'down': # ...   This might seem like pythonic code, but its simplicity could bite you. If you have a lot of conditions and perhaps in multiple locations in your code, what happens if you mistype any of those string literals?"><link href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,300italic,400italic|Raleway:500,100,300" rel=stylesheet><link rel=stylesheet type=text/css media=screen href=/css/normalize.css><link rel=stylesheet type=text/css media=screen href=/css/main.css><script src=https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js></script><script src=/js/main.js></script></head><body><div class="container wrapper post"><div class=header><h1 class=site-title>Andreas Bergström</h1><div class=site-description><h2>Full Stack Web Developer</h2><nav class="nav social"><ul class=flat><a href=https://github.com/andreas-bergstrom title=Github><i data-feather=github></i></a><a href=https://www.linkedin.com/in/andreaserikbergstrom/ title=LinkedIn><i data-feather=linkedin></i></a><a href=https://stackoverflow.com/users/1202214/andreas-bergstr%c3%b6m title="Stack Overflow"><i data-feather=paperclip></i></a><a href=https://twitter.com/echoandreas title=Twitter><i data-feather=twitter></i></a><a href=mailto:hi@andreasbergstrom.com title="Send email"><i data-feather=mail></i></a></ul></nav></div><nav class=nav><ul class=flat><li><a href=/>Home</a></li><li><a href=/posts>All posts</a></li><li><a href=/about-me>About</a></li><li><a href=/tags>Tags</a></li></ul></nav></div><div class=post-header><h1 class=title>Python Tips and Gotchas #1 - Replace literals with constants in if-expressions</h1><div class=meta>2019-03-03 - 437 words - 3 minutes to read</div><div class=meta>Tagged with<span class=tag><a href=https://andreasbergstrom.com/tags/python>python</a></span><span class=tag><a href=https://andreasbergstrom.com/tags/tips-and-gotchas>tips-and-gotchas</a></span></div></div><div class=markdown><p>Whenever you need to check the value of a basic data type, the most straight-forward solution is to use literals:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#00f>if</span> direction == <span style=color:#a31515>&#39;up&#39;</span>:
  <span style=color:green># ...</span>
<span style=color:#00f>elif</span> direction == <span style=color:#a31515>&#39;down&#39;</span>:
  <span style=color:green># ...</span></code></pre></td></tr></table></div></div><p>This might seem like pythonic code, but its simplicity could bite you. If you have a lot of conditions and perhaps in multiple locations in your code, what happens if you mistype any of those string literals? Python will not complain, and there will not be any runtime errors. But you will end up with logical errors that could be insanely hard to track down.</p><p>Numeric literals are double trouble as the also comes with the issue of <a href=https://en.wikipedia.org/wiki/Magic_number_(programming)>magic numbers</a>. In the following example we not only have to guess what the number 545 really means, but it is almost easier to mistype than a string since we can not use common sense to detect a spelling error:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#00f>if</span> error_code == 545:
  <span style=color:green># ...</span></code></pre></td></tr></table></div></div><p>In order to make your code more readable and to make it crash on any typos, using constants is often recommended. Simply extract the raw values into appropriately located constants (in Python just uppercased variables) and use the constants in the all if-expressions:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>UP = <span style=color:#a31515>&#39;up&#39;</span>
DOWN = <span style=color:#a31515>&#39;down&#39;</span>

<span style=color:#00f>if</span> direction == UP:
  <span style=color:green># ...</span></code></pre></td></tr></table></div></div><p>And with numeric literals:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>SERVER_DOWN = 100
CONNECTION_ERROR = 200

<span style=color:#00f>if</span> error_code == SERVER_DOWN:
  <span style=color:green># ...</span></code></pre></td></tr></table></div></div><p>In the first example Python will throw a NameError if you by mistake type &ldquo;UPP&rdquo;, &ldquo;uP&rdquo; or &ldquo;OP&rdquo;. Had we used string literals, Python would have had no way to recognize your typing error.</p><p>In larger projects you could group all constants in one or more modules. Since Python 3.4 there is also a new tool to help organize this: enums.</p><p>Enums are declared as classes but inherit from enum.Enum. This allows us to group related constants under a canonical name:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#00f>import</span> enum

<span style=color:#00f>class</span> <span style=color:#2b91af>ErrorCode</span>(enum.Enum):
  SERVER_DOWN = 100
  CONNECTION_ERROR = 200

error = 100

<span style=color:#00f>if</span> error == ErrorCode.SERVER_DOWN.value:
    <span style=color:#00f>print</span>(<span style=color:#a31515>&#39;Server is down&#39;</span>)</code></pre></td></tr></table></div></div><p>Enums can be compared with the <strong><em>is</em></strong> keyword. If you are in control of how each operand in a comparison is created, you could therefor use enums throughout your code to increase the readability even futher:</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#00f>import</span> enum

<span style=color:#00f>class</span> <span style=color:#2b91af>ErrorCode</span>(enum.Enum):
  SERVER_DOWN = 100
  CONNECTION_ERROR = 200

error = ErrorCode.CONNECTION_ERROR

<span style=color:#00f>if</span> error <span style=color:#00f>is</span> ErrorCode.CONNECTION_ERROR:
    <span style=color:#00f>print</span>(<span style=color:#a31515>&#39;There is a connetion error&#39;</span>)</code></pre></td></tr></table></div></div><p>Do however keep in mind that <a href=https://stackoverflow.com/questions/30812793/how-to-use-python-3-4s-enums-without-significant-slowdown>enum attribute lookups are slower than regular attributes lookups</a>.</p></div><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname=="localhost")
return;var dsq=document.createElement('script');dsq.type='text/javascript';dsq.async=true;var disqus_shortname='andreasbergstromcom';dsq.src='//'+disqus_shortname+'.disqus.com/embed.js';(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script><noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by
Disqus.</a></noscript><a href=http://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><div class="footer wrapper"><nav class=nav><div>Built with <a href=https://gohugo.io>Hugo</a></div></nav></div><script>feather.replace()</script><script>var clicky_site_ids=clicky_site_ids||[];clicky_site_ids.push(100897614);</script><script async src=//static.getclicky.com/js></script></body></html>