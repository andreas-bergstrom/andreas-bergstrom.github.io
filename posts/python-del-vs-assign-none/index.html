<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=theme-color content=#494f5c><meta name=msapplication-TileColor content=#494f5c><meta itemprop=name content="Python del vs assigning to None"><meta itemprop=description content="Python utilizes garbage collection to free the developer from the hassle of manually handling allocating and de-allocating memory. But there are still some details that could suprise you unless you are aware of them.
Because even though the Python runtime will take care of memory management, sometimes developers will want to manually tell the garbage colletor that a variable is no longer needed. Either because they are doing some edge-case optimization and really know what they are doing or they think they are smart but have no idea what they are doing."><meta itemprop=datePublished content=2019-03-01T00:00:00&#43;00:00><meta itemprop=dateModified content=2019-03-01T00:00:00&#43;00:00><meta itemprop=wordCount content=656><meta itemprop=keywords content="python,memory management,"><meta property=og:title content="Python del vs assigning to None"><meta property=og:description content="Python utilizes garbage collection to free the developer from the hassle of manually handling allocating and de-allocating memory. But there are still some details that could suprise you unless you are aware of them.
Because even though the Python runtime will take care of memory management, sometimes developers will want to manually tell the garbage colletor that a variable is no longer needed. Either because they are doing some edge-case optimization and really know what they are doing or they think they are smart but have no idea what they are doing."><meta property=og:type content=article><meta property=og:url content=https://andreasbergstrom.com/posts/python-del-vs-assign-none/><meta property=article:published_time content=2019-03-01T00:00:00&#43;00:00><meta property=article:modified_time content=2019-03-01T00:00:00&#43;00:00><meta name=twitter:card content=summary><meta name=twitter:title content="Python del vs assigning to None"><meta name=twitter:description content="Python utilizes garbage collection to free the developer from the hassle of manually handling allocating and de-allocating memory. But there are still some details that could suprise you unless you are aware of them.
Because even though the Python runtime will take care of memory management, sometimes developers will want to manually tell the garbage colletor that a variable is no longer needed. Either because they are doing some edge-case optimization and really know what they are doing or they think they are smart but have no idea what they are doing."><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color><link rel="shortcut icon" href=/favicon.ico><title>Python del vs assigning to None</title><link rel=stylesheet href=https://andreasbergstrom.com/css/style.min.c693329ce3bac2503f88115a4011a284a06d53e30f484562a37664dc4c5f0a74.css integrity="sha256-xpMynOO6wlA/iBFaQBGihKBtU+MPSEVio3Zk3ExfCnQ="><meta name=description content></head><body id=page><header id=site-header class="animated slideInUp faster"><div class="hdr-wrapper section-inner"><div class=hdr-left><div class=site-branding><a href=https://andreasbergstrom.com/>Andreas Bergstr√∂m</a></div><nav class="site-nav hide-in-mobile"><a href=https://andreasbergstrom.com/posts/>Blog</a>
<a href=https://andreasbergstrom.com/tags/>Tags</a>
<a href=https://andreasbergstrom.com/about-me/>About me</a></nav></div><div class="hdr-right hdr-icons"><span class="hdr-social hide-in-mobile"><a href=https://twitter.com/echoandreas target=_blank rel=noopener title=Twitter><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9.0 0 1-3.14 1.53 4.48 4.48.0 0 0-7.86 3v1A10.66 10.66.0 0 1 3 4s-4 9 5 13a11.64 11.64.0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5.0 0 0-.08-.83A7.72 7.72.0 0 0 23 3z"/></svg></a><a href=https://instagram.com/andreas_erik_bergstrom target=_blank rel=noopener title=Instagram><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-instagram"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"/><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/><path d="M17.5 6.5v0z"/></svg></a><a href=https://github.com/andreas-bergstrom target=_blank rel=noopener title=Github><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0 0 20 4.77 5.07 5.07.0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38.0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 0 0 5 4.77a5.44 5.44.0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 0 0 9 18.13V22"/></svg></a><a href=mailto:hi@andreasbergstrom.com target=_blank rel=noopener title=Email><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mail"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><path d="M22 6 12 13 2 6"/></svg></a><a href=https://linkedin.com/in/andreaserikbergstrom target=_blank rel=noopener title=Linkedin><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-linkedin"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"/><path d="M2 9h4v12H2z"/><circle cx="4" cy="4" r="2"/></svg></a><a href=https://stackoverflow.com/users/1202214/andreas-bergstr%c3%b6m target=_blank rel=noopener title=Stackoverflow><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M18.986 21.865v-6.404h2.134V24H1.844v-8.539h2.13v6.404h15.012zM6.111 19.731H16.85v-2.137H6.111v2.137zm.259-4.852 10.48 2.189.451-2.07-10.478-2.187-.453 2.068zm1.359-5.056 9.705 4.53.903-1.95-9.706-4.53-.902 1.936v.014zm2.715-4.785 8.217 6.855 1.359-1.62-8.216-6.853-1.35 1.617-.01.001zM15.751.0l-1.746 1.294 6.405 8.604 1.746-1.294L15.749.0h.002z"/></svg></a></span><button id=menu-btn class=hdr-btn title=Menu><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><path d="M3 12H21z"/><path d="M3 6H21z"/><path d="M3 18H21z"/></svg></button></div></div></header><div id=mobile-menu class="animated fast"><ul><li><a href=https://andreasbergstrom.com/posts/>Blog</a></li><li><a href=https://andreasbergstrom.com/tags/>Tags</a></li><li><a href=https://andreasbergstrom.com/about-me/>About me</a></li></ul></div><main class="site-main section-inner animated fadeIn faster"><article class=thin><header class=post-header><div class=post-meta><span>Mar 1, 2019</span></div><h1>Python del vs assigning to None</h1></header></aside><div class=content><p>Python utilizes garbage collection to free the developer from the hassle of manually handling allocating and de-allocating memory. But there are still some details that could suprise you unless you are aware of them.</p><p>Because even though the Python runtime will take care of memory management, sometimes developers will want to manually tell the garbage colletor that a variable is no longer needed. Either because they are doing some edge-case optimization and really know what they are doing or they think they are smart but have no idea what they are doing. Most likely the latter as the Python runtime most often does not release unused memory back to the operating system.</p><p>But when someone need to somehow mark a variable as ready to be freed by the garbage collector, there are usually two solutions they come across:</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=n>x</span> <span class=o>=</span> <span class=bp>None</span></code></pre></div><p>or</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=k>del</span> <span class=n>x</span></code></pre></div><p>The difference is that <strong>x = None</strong> will free whatever it referenced but keep the name around even though it&rsquo;s just referencing None (which is a type, NoneType).</p><p>On the other hand <strong>del x</strong> will completely remove both the name and what it referenced. If you thereafter try to use x an NameError will be thrown (or AttributeError in case of a object property).</p><p>So in practice, by assigning None to a name you can still use it in expressions while using del the name is completely removed. In the first case a few bytes is needed to keep the name in memory, while the later completely clears all memory usage.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code class=language-python data-lang=python><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-python data-lang=python><span class=kn>import</span> <span class=nn>sys</span>
<span class=kn>import</span> <span class=nn>gc</span>

<span class=n>x</span> <span class=o>=</span> <span class=s1>&#39;Some text here to give the variable a decent size&#39;</span>
<span class=n>y</span> <span class=o>=</span> <span class=mi>2</span>
<span class=k>print</span><span class=p>(</span><span class=s1>&#39;x value before deletion: {}&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>x</span><span class=p>))</span>
<span class=k>print</span><span class=p>(</span><span class=s1>&#39;x size before deletion: {} bytes&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>sys</span><span class=o>.</span><span class=n>getsizeof</span><span class=p>(</span><span class=n>x</span><span class=p>)))</span>
<span class=k>print</span><span class=p>(</span><span class=s1>&#39;y value before deletion: {}&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>y</span><span class=p>))</span>

<span class=n>x</span> <span class=o>=</span> <span class=bp>None</span>
<span class=k>del</span> <span class=n>y</span>
<span class=n>gc</span><span class=o>.</span><span class=n>collect</span><span class=p>()</span> <span class=c1># Not really needed, just to show garbage collection has been done hereafter</span>

<span class=k>print</span><span class=p>(</span><span class=s1>&#39;x value after deletion: {}&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>x</span><span class=p>))</span>
<span class=k>print</span><span class=p>(</span><span class=s1>&#39;x size after deletion: {} bytes&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>sys</span><span class=o>.</span><span class=n>getsizeof</span><span class=p>(</span><span class=n>x</span><span class=p>)))</span> <span class=c1># A few bytes needed to keep symbol name</span>
<span class=k>print</span><span class=p>(</span><span class=s1>&#39;x type after deletion: {}&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=nb>type</span><span class=p>(</span><span class=n>x</span><span class=p>)))</span>

<span class=k>if</span> <span class=ow>not</span> <span class=n>x</span><span class=p>:</span>
    <span class=k>print</span><span class=p>(</span><span class=s1>&#39;Can still use x!&#39;</span><span class=p>)</span>

<span class=k>print</span><span class=p>(</span><span class=s1>&#39;y value after deletion: {}&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>y</span><span class=p>))</span> <span class=c1># Will throw NameError (AttributeError in case of class property)</span></code></pre></td></tr></table></div></div><p>Output:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>x value before deletion: Some text here to give the variable a decent size
x size before deletion: <span class=m>98</span> bytes
y value before deletion: <span class=m>2</span>
x value after deletion: None
x size after deletion: <span class=m>16</span> bytes
x <span class=nb>type</span> after deletion: &lt;class <span class=s1>&#39;NoneType&#39;</span>&gt;
Can still use x!
Traceback <span class=o>(</span>most recent call last<span class=o>)</span>:
  File <span class=s2>&#34;Untitled.py&#34;</span>, line <span class=m>21</span>, in &lt;module&gt;
    print<span class=o>(</span><span class=s1>&#39;y value after deletion: {}&#39;</span>.format<span class=o>(</span>y<span class=o>))</span> <span class=c1># Will throw NameError (AttributeError in case of class property)</span>
NameError: name <span class=s1>&#39;y&#39;</span> is not defined</code></pre></div><p>As you can see in the error above, if you for whatever reason need to hook into the memory management, unless you know the difference between assigning to None and using <strong>del</strong> it could confuse you.</p><p>Let us now look at the bytecode to see the technical difference:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code class=language-python data-lang=python><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-python data-lang=python><span class=kn>import</span> <span class=nn>gc</span>
<span class=kn>import</span> <span class=nn>dis</span>

<span class=k>def</span> <span class=nf>using_none</span><span class=p>():</span>
	<span class=n>x</span> <span class=o>=</span> <span class=mi>1</span>

	<span class=n>x</span> <span class=o>=</span> <span class=bp>None</span> <span class=c1># &lt;-- ASSIGNING TO NONE</span>

<span class=k>def</span> <span class=nf>using_del</span><span class=p>():</span>
	<span class=n>x</span> <span class=o>=</span> <span class=mi>1</span>

	<span class=k>del</span> <span class=n>x</span> <span class=c1># &lt;-- USING DEL</span>

<span class=k>print</span><span class=p>(</span><span class=s2>&#34;Bytecode when assigning to None:&#34;</span><span class=p>)</span>
<span class=n>dis</span><span class=o>.</span><span class=n>dis</span><span class=p>(</span><span class=n>using_none</span><span class=p>)</span>
<span class=k>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Bytecode when using del:&#34;</span><span class=p>)</span>
<span class=n>dis</span><span class=o>.</span><span class=n>dis</span><span class=p>(</span><span class=n>using_del</span><span class=p>)</span></code></pre></td></tr></table></div></div><p>Output:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>Bytecode when assigning to None:
  <span class=m>5</span>           <span class=m>0</span> LOAD_CONST               <span class=m>1</span> <span class=o>(</span><span class=m>1</span><span class=o>)</span>
              <span class=m>2</span> STORE_FAST               <span class=m>0</span> <span class=o>(</span>x<span class=o>)</span>

  <span class=m>7</span>           <span class=m>4</span> LOAD_CONST               <span class=m>0</span> <span class=o>(</span>None<span class=o>)</span>
              <span class=m>6</span> STORE_FAST               <span class=m>0</span> <span class=o>(</span>x<span class=o>)</span>
              <span class=m>8</span> LOAD_CONST               <span class=m>0</span> <span class=o>(</span>None<span class=o>)</span>
             <span class=m>10</span> RETURN_VALUE

Bytecode when using del:
 <span class=m>10</span>           <span class=m>0</span> LOAD_CONST               <span class=m>1</span> <span class=o>(</span><span class=m>1</span><span class=o>)</span>
              <span class=m>2</span> STORE_FAST               <span class=m>0</span> <span class=o>(</span>x<span class=o>)</span>

 <span class=m>12</span>           <span class=m>4</span> DELETE_FAST              <span class=m>0</span> <span class=o>(</span>x<span class=o>)</span>
              <span class=m>6</span> LOAD_CONST               <span class=m>0</span> <span class=o>(</span>None<span class=o>)</span>
              <span class=m>8</span> RETURN_VALUE</code></pre></div><p>So using <strong>del</strong> results in only one bytecode, DELETE_FAST, while assigning to None actually runs a full assignment using LOAD_CONST and STORE_FAST. The last LOAD_CONST before RETURN_VALUE in both functions is simply the return value None that every Python function implicitly returns.</p></div><hr class=post-end><footer class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83.0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"/><path d="M7 7V7z"/></svg><span class=tag><a href=https://andreasbergstrom.com/tags/python>python</a></span><span class=tag><a href=https://andreasbergstrom.com/tags/memory-management>memory management</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2V8h6"/><path d="M16 13H8z"/><path d="M16 17H8z"/><path d="M10 9H9 8"/></svg>656 Words</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><path d="M16 2V6z"/><path d="M8 2V6z"/><path d="M3 10H21z"/></svg>2019-03-01 01:00 &#43;0100</p></footer></article><div class="post-nav thin"><a class=next-post href=https://andreasbergstrom.com/posts/python-argparse/><span class=post-nav-label><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left"><path d="M19 12H5z"/><path d="M12 19 5 12l7-7"/></svg>&nbsp;Newer</span><br><span>argparse - modern Python command line arguments</span></a></div><div id=comments class=thin></div></main><footer id=site-footer class="section-inner thin animated fadeIn faster"><p>&copy; 2019 <a href=https://andreasbergstrom.com/>Andreas Bergstr√∂m</a></p><p>Made with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> &#183; Theme <a href=https://github.com/Track3/hermit target=_blank rel=noopener>Hermit</a> &#183; <a href=https://andreasbergstrom.com/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"/><path d="M4 4a16 16 0 0 1 16 16"/><circle cx="5" cy="19" r="1"/></svg></a></p></footer><script src=https://andreasbergstrom.com/js/main.min.8f39f24808e9d0a9b02da58c2d2838da859dc0b7bdfadbdb1883aae8b6adacfe.js integrity="sha256-jznySAjp0KmwLaWMLSg42oWdwLe9+tvbGIOq6LatrP4="></script><script>var clicky_site_ids=clicky_site_ids||[];clicky_site_ids.push(100897614);</script><script async src=//static.getclicky.com/js></script></body></html>